{"ast":null,"code":"import database from './utils/Database';\nimport ownsRecord from './middleware/OwnsRecord';\nexport default auth0.requireAuthentication(async (req, res) => {\n  const {\n    user\n  } = await auth0.getSession(req);\n  const {\n    id,\n    fields\n  } = req.body;\n\n  try {\n    const existingRecord = await table.find(id);\n\n    if (!existingRecord || user.sub !== existingRecord.fields.userId) {\n      return res.status(404).json({\n        msg: 'Record not found'\n      });\n    }\n\n    req.record = existingRecord;\n    const updatedRecord = await database.updateOne({\n      id,\n      fields\n    });\n    return res.json(updatedRecord);\n  } catch (e) {\n    console.log(e);\n    return res.status(500).json({\n      mgs: 'Somethig went wrong'\n    });\n  }\n});","map":{"version":3,"sources":["/Users/misha/Documents/learn_project/JS/next-authenticated-todo-app/pages/api/updateTodo.js"],"names":["database","ownsRecord","auth0","requireAuthentication","req","res","user","getSession","id","fields","body","existingRecord","table","find","sub","userId","status","json","msg","record","updatedRecord","updateOne","e","console","log","mgs"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,kBAArB;AACA,OAAOC,UAAP,MAAuB,yBAAvB;AAEA,eAAeC,KAAK,CAACC,qBAAN,CAA4B,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AAC7D,QAAM;AAAEC,IAAAA;AAAF,MAAW,MAAMJ,KAAK,CAACK,UAAN,CAAiBH,GAAjB,CAAvB;AACA,QAAM;AAAEI,IAAAA,EAAF;AAAMC,IAAAA;AAAN,MAAiBL,GAAG,CAACM,IAA3B;;AACA,MAAI;AACF,UAAMC,cAAc,GAAG,MAAMC,KAAK,CAACC,IAAN,CAAWL,EAAX,CAA7B;;AACA,QAAI,CAACG,cAAD,IAAmBL,IAAI,CAACQ,GAAL,KAAaH,cAAc,CAACF,MAAf,CAAsBM,MAA1D,EAAkE;AAChE,aAAOV,GAAG,CAACW,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,QAAAA,GAAG,EAAE;AAAP,OAArB,CAAP;AACD;;AACDd,IAAAA,GAAG,CAACe,MAAJ,GAAaR,cAAb;AACA,UAAMS,aAAa,GAAG,MAAMpB,QAAQ,CAACqB,SAAT,CAAmB;AAAEb,MAAAA,EAAF;AAAMC,MAAAA;AAAN,KAAnB,CAA5B;AACA,WAAOJ,GAAG,CAACY,IAAJ,CAASG,aAAT,CAAP;AACD,GARD,CAQE,OAAOE,CAAP,EAAU;AACVC,IAAAA,OAAO,CAACC,GAAR,CAAYF,CAAZ;AACA,WAAOjB,GAAG,CAACW,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEQ,MAAAA,GAAG,EAAE;AAAP,KAArB,CAAP;AACD;AACF,CAfc,CAAf","sourcesContent":["import database from './utils/Database'\nimport ownsRecord from './middleware/OwnsRecord'\n\nexport default auth0.requireAuthentication(async (req, res) => {\n  const { user } = await auth0.getSession(req)\n  const { id, fields } = req.body\n  try {\n    const existingRecord = await table.find(id)\n    if (!existingRecord || user.sub !== existingRecord.fields.userId) {\n      return res.status(404).json({ msg: 'Record not found' })\n    }\n    req.record = existingRecord\n    const updatedRecord = await database.updateOne({ id, fields })\n    return res.json(updatedRecord)\n  } catch (e) {\n    console.log(e)\n    return res.status(500).json({ mgs: 'Somethig went wrong' })\n  }\n})\n"]},"metadata":{},"sourceType":"module"}