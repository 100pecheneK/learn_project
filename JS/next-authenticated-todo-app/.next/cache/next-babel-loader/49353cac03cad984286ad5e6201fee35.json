{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/misha/Desktop/nextblog/todo/contexts/TodosContext.js\";\nimport { createContext, useState, useRef } from 'react';\nconst TodosContext = /*#__PURE__*/createContext();\n\nconst useDeleteTodo = ({\n  id,\n  abortController = new AbortController()\n}) => {\n  const {\n    signal,\n    abort\n  } = abortController || {};\n  const articleRequest = fetch('/api/deleteTodo', {\n    signal: signal,\n    body: JSON.stringify({\n      id\n    }),\n    method: 'DELETE'\n  });\n  return [articleRequest, abort === null || abort === void 0 ? void 0 : abort.bind(abortController)];\n};\n\nconst TodosProvider = ({\n  children\n}) => {\n  const {\n    0: todos,\n    1: setTodos\n  } = useState([]);\n  const abortFuncs = useRef([]);\n\n  const refreshTodos = async () => {\n    try {\n      const res = await fetch('/api/getTodos');\n      const latestTodos = await res.json();\n      setTodos(latestTodos);\n    } catch (e) {\n      console.error(e);\n    }\n  };\n\n  const addTodo = async description => {\n    try {\n      const res = await fetch('/api/createTodo', {\n        method: 'POST',\n        body: JSON.stringify({\n          description\n        }),\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n      const newTodo = await res.json();\n      setTodos(prevTodos => [newTodo, ...prevTodos]);\n    } catch (e) {\n      console.error(e);\n    }\n  };\n\n  const updateTodo = async updatedTodo => {\n    try {\n      await fetch('/api/updateTodo', {\n        method: 'PUT',\n        body: JSON.stringify(updatedTodo),\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n      setTodos(prevTodos => {\n        const existingTodos = [...prevTodos];\n        const existingTodo = existingTodos.find(todo => todo.id === updatedTodo.id);\n        existingTodo.fields = updatedTodo.fields;\n        return existingTodos;\n      });\n    } catch (e) {\n      console.error(e);\n    }\n  };\n\n  const deleteTodo = async id => {\n    try {\n      await fetch('/api/deleteTodo', {\n        method: 'DELETE',\n        body: JSON.stringify({\n          id\n        }),\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n      setTodos(prevTodos => prevTodos.filter(todo => todo.id !== id));\n    } catch (e) {\n      console.error(e);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(TodosContext.Provider, {\n    value: {\n      todos,\n      setTodos,\n      refreshTodos,\n      updateTodo,\n      addTodo,\n      deleteTodo\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 5\n  }, this);\n};\n\nexport { TodosProvider, TodosContext };","map":{"version":3,"sources":["/Users/misha/Desktop/nextblog/todo/contexts/TodosContext.js"],"names":["createContext","useState","useRef","TodosContext","useDeleteTodo","id","abortController","AbortController","signal","abort","articleRequest","fetch","body","JSON","stringify","method","bind","TodosProvider","children","todos","setTodos","abortFuncs","refreshTodos","res","latestTodos","json","e","console","error","addTodo","description","headers","newTodo","prevTodos","updateTodo","updatedTodo","existingTodos","existingTodo","find","todo","fields","deleteTodo","filter"],"mappings":"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","sourcesContent":["import { createContext, useState, useRef } from 'react'\nconst TodosContext = createContext()\n\nconst useDeleteTodo = ({\n  id,\n  abortController = new AbortController(),\n}) => {\n  const { signal, abort } = abortController || {}\n  const articleRequest = fetch('/api/deleteTodo', {\n    signal: signal,\n    body: JSON.stringify({ id }),\n    method: 'DELETE',\n  })\n\n  return [articleRequest, abort?.bind(abortController)]\n}\n\nconst TodosProvider = ({ children }) => {\n  const [todos, setTodos] = useState([])\n  const abortFuncs = useRef([])\n\n  const refreshTodos = async () => {\n    try {\n      const res = await fetch('/api/getTodos')\n      const latestTodos = await res.json()\n      setTodos(latestTodos)\n    } catch (e) {\n      console.error(e)\n    }\n  }\n\n  const addTodo = async description => {\n    try {\n      const res = await fetch('/api/createTodo', {\n        method: 'POST',\n        body: JSON.stringify({ description }),\n        headers: { 'Content-Type': 'application/json' },\n      })\n      const newTodo = await res.json()\n      setTodos(prevTodos => [newTodo, ...prevTodos])\n    } catch (e) {\n      console.error(e)\n    }\n  }\n  const updateTodo = async updatedTodo => {\n    try {\n      await fetch('/api/updateTodo', {\n        method: 'PUT',\n        body: JSON.stringify(updatedTodo),\n        headers: { 'Content-Type': 'application/json' },\n      })\n      setTodos(prevTodos => {\n        const existingTodos = [...prevTodos]\n        const existingTodo = existingTodos.find(\n          todo => todo.id === updatedTodo.id\n        )\n        existingTodo.fields = updatedTodo.fields\n        return existingTodos\n      })\n    } catch (e) {\n      console.error(e)\n    }\n  }\n  const deleteTodo = async id => {\n    try {\n      await fetch('/api/deleteTodo', {\n        method: 'DELETE',\n        body: JSON.stringify({ id }),\n        headers: { 'Content-Type': 'application/json' },\n      })\n      setTodos(prevTodos => prevTodos.filter(todo => todo.id !== id))\n    } catch (e) {\n      console.error(e)\n    }\n  }\n\n  return (\n    <TodosContext.Provider\n      value={{ todos, setTodos, refreshTodos, updateTodo, addTodo, deleteTodo }}\n    >\n      {children}\n    </TodosContext.Provider>\n  )\n}\nexport { TodosProvider, TodosContext }\n"]},"metadata":{},"sourceType":"module"}